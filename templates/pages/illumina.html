{% extends "base.html" %}

{% block title %}Illumina Sequencing Data Analysis{% endblock %}

{% block content %}
    <!-- Модальное окно для незарегистрированных пользователей -->
    {% if not user_authenticated %}
    <div id="registrationModal" class="modal" style="display: block;">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3>Registration Required</h3>
            <p>You need to register or log in to submit data for analysis.</p>
            <div class="modal-actions">
                <a href="/auth/register" class="button button--primary">Register</a>
                <a href="/auth/login" class="button button--secondary">Log In</a>
            </div>
        </div>
    </div>
    {% endif %}

    <form class="form" id="illuminaForm" enctype="multipart/form-data">

        {% if user_authenticated %}
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        {% endif %}

        <h1 class="page__title">Illumina Sequencing Data</h1>
        
        {% include "includes/form_disclaimer.html" %}

        <div class="form__group">
            <label class="form__label">fastq file archive:</label>
            <div class="flex flex--row flex--align-center gap--sm">
                <input type="file" id="fastqFile" class="form__control" accept=".fastq,.gz" required>
                <button type="button" class="button button--secondary" onclick="document.getElementById('fastqFile').click()">Browse...</button>
            </div>
        </div>

        <div class="form__group">
            <label class="form__label">Sequencing type:</label>
            <div class="sequencing-options">
                <label class="sequencing-option">
                    <input type="radio" name="sequencing_type" value="single-end" checked>
                    single-end sequencing
                </label>
                <label class="sequencing-option">
                    <input type="radio" name="sequencing_type" value="paired-end">
                    paired-end sequencing
                </label>
            </div>
        </div>

        <div class="form__group">
            <label class="form__label">Adapter:</label>
            <select class="form__control" id="adapter">
                <option value="default">Default Adapter</option>
                <option value="custom">Custom Adapter</option>
            </select>
        </div>

        {% include "includes/form_common.html" %}

        <div class="form__actions">
            {% if user_authenticated %}
                <button type="submit" class="button button--primary">Submit</button>
            {% else %}
                <button type="button" class="button button--disabled" disabled>Submit</button>
                <span class="registration-hint">Registration required to submit form</span>
            {% endif %}
        </div>
    </form>
{% endblock %}